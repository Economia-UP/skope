scale_x_percent(breaks = seq(min(series.long$value), min(series.long$value), by = 0.005))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value), min(series.long$value), by = 0.005))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(0, min(series.long$value), by = 0.005))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks =
breaks = seq(min(series.long$value, na.rm = TRUE),
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 0.005))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 0.0005))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 0.05))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 0.5))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 5))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 1))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 1/100))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE),
by = 0.5/100))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE)))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
max(series.long$value, na.rm = TRUE))  +
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
max(series.long$value, na.rm = TRUE)))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
# scale_x_percent(breaks = seq(min(series.long$value, na.rm = TRUE),
# max(series.long$value, na.rm = TRUE)))  +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
?scale_x_percent
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(accuracy = 2) +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(accuracy = 3) +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(accuracy = 4) +
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
?scale_x_percent
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(labels = scales::percent_format(accuracy = 0.01)) +  # Two decimal places
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(labels = scales::percent_format(accuracy = 0.01)) +  # Two decimal places
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(labels = scales::percent_format(accuracy = 0.1)) +  # Two decimal places
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
print("mc_expectedinflation.R")
rm(list=ls())
library(siebanxicor)
library(tidyverse)
library(hrbrthemes)
library(showtext)
library(svglite)
font_add_google("Rubik", "Rubik")
showtext_auto()
# Define your INEGI API key
setToken(Sys.getenv("BANXICO_API"))
# Fetch the data using the specified series IDs
idSeries <- c("SR14195", "SR14196","SR14197")
# Get the data
series <- getSeriesData(idSeries)
setToken("86d02771fd6b64ce29912469f70d872cf666627201a5d7e819a82c452ae61289")
# Fetch the data using the specified series IDs
idSeries <- c("SR14195", "SR14196","SR14197")
# Get the data
series <- getSeriesData(idSeries)
med <- getSerieDataFrame(series, "SR14195")
first <- getSerieDataFrame(series, "SR14196")
third <- getSerieDataFrame(series, "SR14197")
series.df <- reduce(list(first, med, third), full_join, by = "date") %>%
filter(date >= Sys.Date() - years(1))
colnames(series.df)[2:4] <- c("Primer cuartil", "Mediana", "Tercer cuartil")
series.long <- series.df %>%
pivot_longer(
!date,
names_to = "index",
values_to = "value"
) %>%
mutate(index = factor(index, levels = c("Primer cuartil", "Mediana", "Tercer cuartil")))
ggplot(series.long, aes(value/100, date, color = index, group = date)) +
geom_line(color = "grey", linewidth = 1) +
geom_point(size = 3) +
labs(
title = paste("Expectativas de inflación", year(Sys.Date())),
subtitle = "Encuestas Sobre las Expectativas de los Especialistas en Economía del \nSector Privado Expectativas de Inflación para los Próximos 12 Meses",
x = "",
y = "",
color = "",
caption = paste("Fuente: Banxico. Última actualización", format(Sys.time(), '%d %b, %Y'))
) +
scale_x_percent(labels = scales::percent_format(accuracy = 0.1)) +  # Two decimal places
scale_color_manual(values=c("#009076", "#ffe59c", "#c71e1d")) +
theme_ipsum_rc(base_family = "Rubik") +
theme(
legend.position = "bottom"
)
ggsave("plots/inflation/expectedinflation.svg",  width = 8, height = 6, create.dir = TRUE)
# Specify the output directory and file name
write.csv(series.df, "data/inflation/expectedinflation.csv", row.names = FALSE, create.dir = TRUE)
?write.csv
?write_csv()
# Specify the output directory and file name
write.csv(series.df, "data/inflation/expectedinflation.csv", row.names = FALSE)
ggsave("plots/inflation/expectedinflation.svg",  width = 8, height = 6, create.dir = TRUE)
# Load required libraries
library(oaxaca)
library(ggplot2)
library(dplyr)
library(readr)
library(httr)  # For downloading files
library(zip)   # For extracting ZIP files
library(tidyverse)
library(httr)  # For downloading files
library(zip)   # For extracting ZIP files
# Define the years and quarters to analyze
anio <- 24  # Use last two digits of the year (e.g., 2024 -> 24)
trimestres <- 1:4
# Define destination folder for downloads
carpeta_destino <- "/r/labor/oaxaca/"
# Ensure the destination folder exists
if (!dir.exists(carpeta_destino)) {
dir.create(carpeta_destino, recursive = TRUE)
}
# Store results
resultados <- data.frame()
# Loop through each quarter
for (trim in trimestres) {
# Construct the ZIP file URL
url <- paste0("https://www.inegi.org.mx/contenidos/programas/enoe/15ymas/microdatos/enoe_2024_trim",
trim, "_csv.zip")
# Define local ZIP file name
archivo_zip <- paste0(carpeta_destino, "enoe_2024_trim", trim, ".zip")
# Download file using httr::GET
response <- GET(url, write_disk(archivo_zip, overwrite = TRUE), timeout(300))  # 300s timeout
# Check if the download was successful
if (http_error(response)) {
print(paste("Failed to download:", url))
next
}
# Extract only the relevant CSV file
unzip(archivo_zip, exdir = carpeta_destino)
# Search for the correct CSV file (ENOE_SDEMT#YY.csv)
patron_csv <- paste0("ENOE_SDEMT", trim, anio, ".csv")
archivo_csv <- list.files(carpeta_destino, pattern = patron_csv, full.names = TRUE)
if (length(archivo_csv) == 0) {
print(paste("No matching CSV found for:", trim))
next  # Skip if no relevant file is found
}
# Load the dataset
datos <- read_csv(archivo_csv[1])  # Adjust if needed based on structure
# Create necessary variables for analysis
datos <- datos %>%
mutate(log_ingocup = log(ingocup),
exp = eda - anios_esc - 6,
exp2 = exp^2)
# Filter out invalid values
datos <- datos %>% filter(!is.na(log_ingocup) & !is.na(sex))
# Define Oaxaca-Blinder model
modelo <- log_ingocup ~ anios_esc + exp + exp2 + seg_soc + rama + pos_ocu
oaxaca_result <- oaxaca(modelo, data = datos, group = "sex", R = 100)
# Extract estimated wage gap
wage_gap <- oaxaca_result$overall[3, "estimate"]  # Unexplained wage gap component
# Store results
resultados <- rbind(resultados, data.frame(Año = 2024, Trimestre = trim, Wage_Gap = wage_gap))
# Print progress
print(paste("Processed: 2024 Trimestre:", trim))
}
url <- paste0("https://www.inegi.org.mx/contenidos/programas/enoe/15ymas/microdatos/enoe_2024_trim",
trim, "_csv.zip")
archivo_zip <- paste0(carpeta_destino, "enoe_2024_trim", trim, ".zip")
response <- GET(url, write_disk(archivo_zip, overwrite = TRUE), timeout(300))  # 300s timeout
if (http_error(response)) {
print(paste("Failed to download:", url))
next
}
unzip(archivo_zip, exdir = carpeta_destino)
patron_csv <- paste0("ENOE_SDEMT", trim, anio, ".csv")
archivo_csv <- list.files(carpeta_destino, pattern = patron_csv, full.names = TRUE)
q <- 1
year <- 24
# Construct the ZIP file URL
url <- paste0("https://www.inegi.org.mx/contenidos/programas/enoe/15ymas/microdatos/enoe_20",year,"_","trim",
q, "_csv.zip")
archivo_zip <- paste0(folder, "enoe_20",year,"_trim", q, ".zip")
response <- GET(url, write_disk(archivo_zip, overwrite = TRUE), timeout(300))  # 300s timeout
# Define destination folder for downloads
folder <- "/r/labor/oaxaca/"
url <- paste0("https://www.inegi.org.mx/contenidos/programas/enoe/15ymas/microdatos/enoe_20",year,"_","trim",
q, "_csv.zip")
archivo_zip <- paste0(folder, "enoe_20",year,"_trim", q, ".zip")
response <- GET(url, write_disk(archivo_zip, overwrite = TRUE), timeout(300))  # 300s timeout
unzip(archivo_zip, exdir = folder)
patron_csv <- paste0("ENOE_SDEMT", q, year, ".csv")
archivo_csv <- list.files(carpeta_destino, pattern = patron_csv, full.names = TRUE)
